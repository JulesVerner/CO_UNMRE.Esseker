//#include "script_component.hpp"

params ["_camera", "_args"];
_args params ["", "_duration", "_object", ["_offset",[0,0,0]], ["_targetOffset",[0,0,0]], ["_zoom", 0.75]];

if (typeName _object isEqualTo "CODE") then {
    _object = call _object;
};

if (typeName _targetOffset isEqualTo "CODE") then {
    _targetOffset = call _targetOffset;
};

// hint (str _targetOffset + str _offset);

_camera camSetTarget (_object modelToWorldVisual _targetOffset);
_camera camSetFOV _zoom;
_camera camCommit 0;
_camera setPos (_object modelToWorldVisual _offset);

[{
    params ["_args", "_handle"];
    _args params ["_camera", "_object", "_targetOffset", "_offset"];

    if (isNull _camera) exitWith { [_handle] call CBA_fnc_removePerFrameHandler; };

    _camera camSetTarget (_object modelToWorldVisual _targetOffset);
    _camera camCommit 0;
    _camera setPos (_object modelToWorldVisual _offset);
    
}, 0, [_camera, _object, _targetOffset, _offset]] call CBA_fnc_addPerFrameHandler;


[
    {
        detach _this;
    },
    _camera,
    _duration
] call CBA_fnc_waitAndExecute;
